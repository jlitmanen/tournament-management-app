<%- include('./partials/openSelector.ejs', { opens: opens }) %>

<% if (openMatches && openMatches && openMatches.length > 0) { %>
	<div class="container align-content-start p-2">
		<h1><%- open.name %> <%- open.year %></h1>
  <div class="row justify-content-between p-2">
		<%
          // Prepare an empty container for the three rounds we need
          const rounds = {
            1: [],   // first 4 matches
            2: [],   // next 2 matches
            3: [] // the very last match
          };

          // Walk through the matches in the order they appear
          openMatches.forEach((match, idx) => {
            if (idx < 4) {
              // indices 0‑3 → round 1
              rounds[1].push(match);
            } else if (idx < 6) {
              // indices 4‑5 → round 2
              rounds[2].push(match);
            } else {
              // everything after that (in your case just one) → final
              rounds[3].push(match);
            }
          });
        %>

			<% Object.keys(rounds).forEach(round => { %>
				<div class="col shadow-sm p-2">
					<h2>
						<% if (round == 1) { %>1/4 Finaali<% }
						else if (round == 2) { %>Semifinaali<% }
						else if (round == 3) { %>Finaali<% } %>
					</h2>
					<div class="col">
						<% rounds[round].forEach(match => { %>
							<%- include('./partials/match.ejs', { match: match }) %>
						<% }); %>
					</div>
				</div>
			<% }); %>
		</div>
	</div>
<% } else { %>
	<% if (open == null) { %>
		<div class="alert alert-warning" role="alert">
			Select tournament!
		</div>
	<% } else { %>
		<div class="alert alert-warning" role="alert">
			The tournament has not started
		</div>
	<% } %>
<% } %>
